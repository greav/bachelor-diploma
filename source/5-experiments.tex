
\section{Глава 5. Эксперименты}

Для проведения экспериментов с моделями машинного обучения была выбрана библиотека scikit learn \cite{sklearn} и язык программирования python3. Данная библиотека имеет в своем распоряжении множество модулей для работы с моделями машинного обучения и понятный интерфейс для взаимодействиями. 


% \setlength\extrarowheight{8pt}
% \begin{table}[h!]
% \begin{tabular}{|c||m{5em}|m{5em}|m{5em}|l|}
% \hline
% \textbf{Выборка}                                                             & Исходная & Scaled  & OHE    & OHE + Scaled \\ [3ex] \hline  
% \textbf{MAE}                                                                 & 5.4882   & 5.4871  & 3.6179 & 3.6127       \\ [2ex] \hline
% \textbf{Регуляризация}                                                       & Ridge    & Ridge   & Ridge  & Ridge        \\ [2ex] \hline
% \textbf{\begin{tabular}[c]{@{}c@{}}Коэффициент\\ регуляризации\end{tabular}} & 6.251    & 323.746 & 0.001  & 0.001        \\ [3ex] \hline
% \end{tabular}
% \caption{Результаты линейной регрессии}
% \label{table1}
% \end{table}

% \setlength\extrarowheight{8pt}
% \begin{table}[h!]
% \centering
% \begin{tabular}{|c|l|}
% \hline
% \textbf{MAE}                 & 2.3151  \\ \hline
% \textbf{n\_estimators}       & 800     \\ \hline
% \textbf{min\_samples\_split} & 5        \\ \hline
% \textbf{min\_samples\_leaf}  & 4        \\ \hline
% \textbf{max\_features}       & sqrt     \\ \hline
% \textbf{max\_depth}          & 90      \\ \hline
% \textbf{bootstrap}           & True     \\ \hline
% \end{tabular}
% \caption{Результаты случайного леса}
% \label{table8}
% \end{table}

% \setlength\extrarowheight{8pt}
% \begin{table}[h!]
% \centering
% \begin{tabular}{|c|l|}
% \hline
% \textbf{Признак}                       & \textbf{Важность} \\ \hline
% school\_grad                           & 0.393929          \\ \hline
% university\_grad                       & 0.226137          \\ \hline
% city                                   & 0.082121          \\ \hline
% school\_city                           & 0.057251          \\ \hline
% grad\_level                            & 0.044712          \\ \hline
% political                              & 0.041852          \\ \hline
% university\_city & 0.039603          \\ \hline
% n\_childs        & 0.031724          \\ \hline
% relation         & 0.030789          \\ \hline
% occupation       & 0.022067          \\ \hline
% country          & 0.017760          \\ \hline
% sex              & 0.012056          \\ \hline
% \end{tabular}
% \caption{Важность признаков случайного леса}
% \label{table3}
% \end{table}

% \setlength\extrarowheight{8pt}
% \begin{table}[h!]
% \begin{tabular}{|l||l|l|l|l|}
% \hline
% \textbf{Выборка}                                                             & Исходная & Scaled   & OHE    & OHE + Scaled \\ \hline
% \textbf{MAE}                                                                 & 4.84     & 3.526472 & 3.9893 & 5.521        \\ \hline
% \textbf{\begin{tabular}[c]{@{}l@{}}Коэффициент\\ регуляризации\end{tabular}} & 2.0235   & 1000     & 10     & 10           \\ \hline
% \end{tabular}
% \caption{Результаты метода опорных векторов}
% \label{table4}
% \end{table}

% \setlength\extrarowheight{8pt}
% \begin{table}[h!]
% \begin{tabular}{|c|l|l|}
% \hline
% \textbf{Выборка}      & Scaled     & OHE + Scaled \\ \hline
% \textbf{MAE}          & 4.3338     & 4.63         \\ \hline
% \textbf{weights}      & uniform    & uniform      \\ \hline
% \textbf{n\_neighbors} & 9          & 8            \\ \hline
% \textbf{p}            & 1          & 1            \\ \hline
% \textbf{leaf\_size}   & 30         & 35           \\ \hline
% \textbf{algorithm}    & ball\_tree & brute        \\ \hline
% \end{tabular}
% \caption{Результаты К ближайших соседей}
% \label{table5}
% \end{table}

% \setlength\extrarowheight{8pt}
% \begin{table}[h!]
% \begin{tabular}{|c|l|}
% \hline
% \textbf{Выборка}            & Исходная \\ \hline
% \textbf{MAE}                & 2.29993  \\ \hline
% \textbf{n\_estimators}      & 1473     \\ \hline
% \textbf{learning\_rate}     & 0.01     \\ \hline
% \textbf{max\_depth}         & 3        \\ \hline
% \textbf{reg\_alpha}         & 138.94   \\ \hline
% \textbf{reg\_lambda}        & 0.0167   \\ \hline
% \textbf{min\_child\_weight} & 1        \\ \hline
% \end{tabular}
% \caption{Результаты градиентного бустинга}
% \label{table6}
% \end{table}

% \begin{table}[h!]
% \begin{tabular}{|c|c|}
% \hline
% \textbf{Признак} & \multicolumn{1}{l|}{\textbf{Важность}} \\ \hline
% school\_grad     & 0.663268                               \\ \hline
% grad\_level      & 0.172434                               \\ \hline
% university\_grad & 0.085924                               \\ \hline
% city             & 0.015953                               \\ \hline
% political        & 0.012669                               \\ \hline
% relation         & 0.011267                               \\ \hline
% occupation       & 0.010281                               \\ \hline
% n\_childs        & 0.009546                               \\ \hline
% school\_city     & 0.006857                               \\ \hline
% sex              & 0.004889                               \\ \hline
% university\_city & 0.004232                               \\ \hline
% country          & 0.002679                               \\ \hline
% \end{tabular}
% \caption{Важность признаков градиентного бустинга}
% \label{table7}
% \end{table}


% \begin{table}[h!]
% \begin{tabular}{|c|l|l|l|l|}
% \hline
% \textbf{Выборка}                                                           & Исходная & Scaled & OHE   & OHE + Scaled \\ \hline
% \textbf{Accuracy}                                                          & 0.69     & 0.685  & 0.71  & 0.7          \\ \hline
% \textbf{Precision}                                                         & 0.69     & 0.69   & 0.71  & 0.703        \\ \hline
% \textbf{Recall}                                                            & 0.99     & 0.98   & 0.99  & 0.97         \\ \hline
% \textbf{F1}                                                                & 0.81     & 0.81   & 0.823 & 0.82         \\ \hline
% \textbf{ROC AUC}                                                           & 0.51     & 0.51   & 0.55  & 0.54         \\ \hline
% \textbf{Регуляризация}                                                     & L1       & L1     & L1    & L1           \\ \hline
% \textbf{\begin{tabular}[c]{@{}c@{}}Параметр \\ регуляризации\end{tabular}} & 0.0336   & 0.234  & 0.234 & 3792.69      \\ \hline
% \end{tabular}
% \caption{Результаты логистической регрессии}
% \label{table8}
% \end{table}

% \begin{table}[h!]
% \begin{tabular}{|c|l|}
% \hline
% \textbf{Выборка}             & Исходная \\ \hline
% \textbf{Accuracy}            & 0.685    \\ \hline
% \textbf{Precision}           & 0.6989   \\ \hline
% \textbf{Recall}              & 0.9489   \\ \hline
% \textbf{F1}                  & 0.8049   \\ \hline
% \textbf{ROC AUC}             & 0.53     \\ \hline
% \textbf{n\_estimators}       & 1600     \\ \hline
% \textbf{min\_samples\_split} & 5        \\ \hline
% \textbf{min\_samples\_leaf}  & 1        \\ \hline
% \textbf{max\_features}       & sqrt     \\ \hline
% \textbf{max\_depth}          & 10       \\ \hline
% \end{tabular}
% \caption{Результаты случайного леса}
% \label{table9}
% \end{table}

% \begin{table}[h!]
% \begin{tabular}{|c|c|}
% \hline
% \textbf{Признак} & \textbf{Важность} \\ \hline
% age              & 0.136             \\ \hline
% city             & 0.127             \\ \hline
% school\_city     & 0.112             \\ \hline
% n\_childs        & 0.109             \\ \hline
% political        & 0.107             \\ \hline
% school\_grad     & 0.096             \\ \hline
% university\_city & 0.086             \\ \hline
% university\_grad & 0.082             \\ \hline
% country          & 0.043             \\ \hline
% relation         & 0.042             \\ \hline
% occupation       & 0.038             \\ \hline
% grad\_level      & 0.016             \\ \hline
% \end{tabular}
% \caption{Важность признаков случайного леса}
% \label{table10}
% \end{table}

% \begin{table}[h!]
% \begin{tabular}{|c|l|l|l|l|}
% \hline
% \textbf{Выборка}                                                             & Исходная & Scaled & OHE    & OHE + Scaled \\ \hline
% \textbf{Accuracy}                                                            & 0.685    & 0.7    & 0.685  & 0.71         \\ \hline
% \textbf{Precision}                                                           & 0.685    & 0.6974 & 0.685  & 0.708        \\ \hline
% \textbf{Recall}                                                              & 1.0      & 0.992  & 1.0    & 0.978        \\ \hline
% \textbf{F1}                                                                  & 0.813    & 0.819  & 0.813  & 0.822        \\ \hline
% \textbf{ROC AUC}                                                             & 0.5      & 0.528  & 0.5    & 0.552        \\ \hline
% \textbf{\begin{tabular}[c]{@{}c@{}}Коэффициент\\ регуляризации\end{tabular}} & 0.0001   & 1.757  & 0.0001 & 0.5689       \\ \hline
% \end{tabular}
% \caption{Результаты метода опорных векторов}
% \label{table11}
% \end{table}


% \begin{table}[h!]
% \centering
% \begin{tabular}{|c|l|l|}
% \hline
% \textbf{Выборка}     & Scaled    & OHE + Scaled \\ \hline
% \textbf{Accuracy}    & 0.7       & 0.71         \\ \hline
% \textbf{Precision}   & 0.7015    & 0.704        \\ \hline
% \textbf{Recall}      & 0.978     & 0.992        \\ \hline
% \textbf{F1}          & 0.817     & 0.824        \\ \hline
% \textbf{ROC AUC}     & 0.536     & 0.543        \\ \hline
% \textbf{weights}     & uniform   & uniform      \\ \hline
% \textbf{n\_neighbors} & 49        & 41           \\ \hline
% \textbf{p}           & 2         & 3            \\ \hline
% \textbf{leaf\_size}   & 20        & 25           \\ \hline
% \textbf{algorithm}   & ball\_tree & auto         \\ \hline
% \end{tabular}
% \caption{Результаты К ближайших соседей}
% \label{table12}
% \end{table}

% \begin{table}[h!]
% \centering
% \begin{tabular}{|c|l|}
% \hline
% \textbf{Выборка}            & Исходная \\ \hline
% \textbf{Accuracy}           & 0.715    \\ \hline
% \textbf{Precision}          & 0.724    \\ \hline
% \textbf{Recall}             & 0.941    \\ \hline
% \textbf{F1}                 & 0.819    \\ \hline
% \textbf{ROC AUC}            & 0,581    \\ \hline
% \textbf{n\_estimators}      & 4314     \\ \hline
% \textbf{learning\_rate}     & 0.01     \\ \hline
% \textbf{max\_depth}         & 3        \\ \hline
% \textbf{reg\_alpha}         & 0.022    \\ \hline
% \textbf{reg\_lambda}        & 1.0      \\ \hline
% \textbf{min\_child\_weight} & 1        \\ \hline
% \end{tabular}
% \caption{Результаты градиентного бустинга}
% \label{table13}
% \end{table}

% \begin{table}[h!]
% \centering
% \begin{tabular}{|c|c|}
% \hline
% \textbf{Признак} & \textbf{Важность} \\ \hline
% n\_childs         & 0.213             \\ \hline
% political        & 0.131             \\ \hline
% grad\_level       & 0.095             \\ \hline
% occupation       & 0.0803            \\ \hline
% university\_grad  & 0.0693            \\ \hline
% relation         & 0.066             \\ \hline
% school\_city      & 0.0623            \\ \hline
% age              & 0.0603            \\ \hline
% school\_grad      & 0.058             \\ \hline
% university\_city  & 0.057             \\ \hline
% city             & 0.056             \\ \hline
% country          & 0.047             \\ \hline
% \end{tabular}
% \caption{Важность признаков градиентного бустинга}
% \label{table14}
% \end{table}






\clearpage